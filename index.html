<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>CalculatorProV2</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<style>
body {
    font-family: Arial;
    background: #0f0f0f;
    color: white;
    margin: 0;
}
.container { padding: 20px; }
.tabs button {
    padding: 8px 12px;
    margin: 3px;
    background: #222;
    border: none;
    color: white;
    cursor: pointer;
}
.section { display: none; margin-top: 20px; }
input, textarea {
    width: 100%;
    padding: 8px;
    margin: 5px 0;
    border-radius: 6px;
    border: none;
}
button { margin: 5px 0; padding: 6px 10px; border: none; border-radius: 6px; cursor: pointer; }
.output {
    background: #222;
    padding: 10px;
    border-radius: 6px;
    min-height: 40px;
}
</style>
</head>
<body>

<div class="container">
<h1>Ultimate Math Lab</h1>

<div class="tabs">
<button onclick="showTab('equation')">Equation Solver</button>
<button onclick="showTab('system')">System Solver</button>
<button onclick="showTab('eigen')">Eigen</button>
<button onclick="showTab('series')">Taylor Series</button>
<button onclick="showTab('integral')">Definite Integral</button>
<button onclick="showTab('diffEq')">Differential Eq</button>
<button onclick="showTab('workspace')">Workspace</button>
</div>

<!-- Equation -->
<div id="equation" class="section">
<h2>Solve Equation</h2>
<input id="eqInput" placeholder="Example: x^2 - 4 = 0">
<button onclick="solveEquation()">Solve</button>
<div id="eqOutput" class="output"></div>
</div>

<!-- System -->
<div id="system" class="section">
<h2>Linear System Solver</h2>
<textarea id="systemInput" placeholder="Example:
2x + y = 5
x - y = 1"></textarea>
<button onclick="solveSystem()">Solve System</button>
<div id="systemOutput" class="output"></div>
</div>

<!-- Eigen -->
<div id="eigen" class="section">
<h2>Eigenvalues & Eigenvectors</h2>
<textarea id="eigenInput" placeholder="[ [2,1],[1,2] ]"></textarea>
<button onclick="computeEigen()">Compute</button>
<div id="eigenOutput" class="output"></div>
</div>

<!-- Taylor -->
<div id="series" class="section">
<h2>Taylor Series</h2>
<input id="seriesInput" placeholder="sin(x)">
<input id="seriesPoint" placeholder="Expansion point (ex: 0)">
<input id="seriesOrder" placeholder="Order (ex: 5)">
<button onclick="taylor()">Expand</button>
<div id="seriesOutput" class="output"></div>
</div>

<!-- Definite Integral -->
<div id="integral" class="section">
<h2>Definite Integral</h2>
<input id="intExpr" placeholder="x^2">
<input id="intA" placeholder="Lower bound">
<input id="intB" placeholder="Upper bound">
<button onclick="definiteIntegral()">Compute</button>
<div id="intOutput" class="output"></div>
</div>

<!-- Differential Equation -->
<div id="diffEq" class="section">
<h2>Differential Equation (dy/dx = f(x,y))</h2>
<input id="diffExpr" placeholder="x + y">
<input id="x0" placeholder="Initial x">
<input id="y0" placeholder="Initial y">
<button onclick="solveDiffEq()">Solve Numerically</button>
<div id="diffPlot"></div>
</div>

<!-- Workspace -->
<div id="workspace" class="section">
<h2>Workspace Save / Load</h2>
<textarea id="workspaceData"></textarea>
<button onclick="saveWorkspace()">Save</button>
<button onclick="loadWorkspace()">Load</button>
</div>

</div>

<script>
function showTab(id){
    document.querySelectorAll('.section').forEach(s=>s.style.display='none');
    document.getElementById(id).style.display='block';
}
showTab('equation');

// Equation Solver
function solveEquation(){
    try{
        let eq = document.getElementById("eqInput").value;
        let sides = eq.split("=");
        let result = math.solve(sides[0] + "-(" + sides[1] + ")", 'x');
        document.getElementById("eqOutput").innerText = JSON.stringify(result);
    }catch{
        document.getElementById("eqOutput").innerText="Error";
    }
}

// System Solver
function solveSystem(){
    try{
        let lines = document.getElementById("systemInput").value.split("\n");
        let eqs = lines.map(l => l.replace("=","-(")+")");
        let result = math.lusolve(
            eqs.map(e=>math.parse(e).toTex()), []
        );
        document.getElementById("systemOutput").innerText="Use matrix form for now";
    }catch{
        document.getElementById("systemOutput").innerText="Error";
    }
}

// Eigen
function computeEigen(){
    try{
        let m = math.matrix(eval(document.getElementById("eigenInput").value));
        let eig = math.eigs(m);
        document.getElementById("eigenOutput").innerText = JSON.stringify(eig);
    }catch{
        document.getElementById("eigenOutput").innerText="Error";
    }
}

// Taylor
function taylor(){
    try{
        let expr = document.getElementById("seriesInput").value;
        let point = Number(document.getElementById("seriesPoint").value);
        let order = Number(document.getElementById("seriesOrder").value);
        let series = math.series(expr,'x',point,order);
        document.getElementById("seriesOutput").innerText = series.toString();
    }catch{
        document.getElementById("seriesOutput").innerText="Error";
    }
}

// Definite Integral
function definiteIntegral(){
    try{
        let expr = document.getElementById("intExpr").value;
        let a = Number(document.getElementById("intA").value);
        let b = Number(document.getElementById("intB").value);
        let f = x => math.evaluate(expr,{x:x});
        let result = math.integrate(f,a,b);
        document.getElementById("intOutput").innerText = result;
    }catch{
        document.getElementById("intOutput").innerText="Error";
    }
}

// Differential Equation (Euler Method)
function solveDiffEq(){
    let expr = document.getElementById("diffExpr").value;
    let x = Number(document.getElementById("x0").value);
    let y = Number(document.getElementById("y0").value);

    let xs=[], ys=[];
    let h = 0.1;

    for(let i=0;i<100;i++){
        xs.push(x);
        ys.push(y);
        y = y + h * math.evaluate(expr,{x:x,y:y});
        x += h;
    }

    Plotly.newPlot('diffPlot',[{x:xs,y:ys,type:'scatter'}]);
}

// Workspace Save/Load
function saveWorkspace(){
    localStorage.setItem("mathWorkspace",
        document.getElementById("workspaceData").value);
}
function loadWorkspace(){
    document.getElementById("workspaceData").value =
        localStorage.getItem("mathWorkspace") || "";
}
</script>

</body>
</html>
